extends /layout

block content
	section#first.parallax.imagebg.lightblue(data-overlay="5")
		.background-image-holder
			img(src="/img/headers/home.jpg")
		.container
			.row.text-center
				.col-sm-12
					img(src="/img/logo/logo-white.png")
					a.btn.blue(href="#")
						span.btn__text Learn More
	section.bg-brown
		.container
			.row.text-center
				.col-sm-12
					h3.color-white What is SGMA?
					p.color-white.
						In September 2014, Governor Edmund G. Brown Jr. signed a three-bill package known as the Sustainable Groundwater Management Act (SGMA). The legislation allows local agencies to customize groundwater sustainability plans to their regional economic and environmental needs. SGMA creates a framework for sustainable, local groundwater management for the first time in California history.
					p.color-white.
						“A central feature of these bills is the recognition that groundwater management in California is best accomplished locally. Local agencies will now have the power to assess the conditions of their local groundwater basins and take the necessary steps to bring those basins in a state of chronic long-term overdraft into balance.” 
					p.color-white.text-right.
						– Governor Edmund G. Brown Jr.
	section#about
		.container
			.row.text-center
				.col-sm-12
					h3.color-blue The Sustainable Groundwater Management Act...
			#SGMAbullets.row
				.col-sm-12
					.row.text-center
						.col-sm-3.SGMAbullet
							.front.bg-brown
								.container.pos-vertical-center
									p Provides for sustainable management of groundwater basins
							.back.imagebg
								.background-image-holder
									img(src="/img/test.jpg")
						.col-sm-3.SGMAbullet
							.front.bg-brown
								.container.pos-vertical-center
									p Enhances local management of groundwater consistent with rights to use or store groundwater
							.back.imagebg
								.background-image-holder
									img(src="/img/test.jpg")
						.col-sm-3.SGMAbullet
							.front.bg-brown
								.container.pos-vertical-center
									p Establishes minimum standards for effective, continuous management of groundwater
							.back.bg-lightblue
								.container.pos-vertical-center
									p background test!
						.col-sm-3.SGMAbullet
							.front.bg-brown
								.container.pos-vertical-center
									p Provides local groundwater agencies with the authority, technical, and financial assistance needed to maintain groundwater supplies
							.back.bg-lightblue
								.container.pos-vertical-center
									p background test!
						.col-sm-3.SGMAbullet
							.front.bg-brown
								.container.pos-vertical-center
									p Avoids or minimizes impacts for land subsidence
							.back.bg-lightblue
								.container.pos-vertical-center
									p background test!
						.col-sm-3.SGMAbullet
							.front.bg-brown
								.container.pos-vertical-center
									p Improves data collection and understanding of groundwater resources and management
							.back.bg-lightblue
								.container.pos-vertical-center
									p background test!
						.col-sm-3.SGMAbullet
							.front.bg-brown
								.container.pos-vertical-center
									p Increases groundwater storage and removes impediments to recharge
							.back.bg-lightblue
								.container.pos-vertical-center
									p background test!
						.col-sm-3.SGMAbullet
							.front.bg-brown
								.container.pos-vertical-center
									p Empowers local agencies to manage groundwater basins, while minimizing state intervention
							.back.bg-lightblue
								.container.pos-vertical-center
									p background test!
				
	section.bg-brown
		.container
			.row.text-center
				.col-sm-12
					h3.color-white SGMA Implementation in Tulare County
					p.color-white.
						There are three groundwater sub-basins in Tulare County, they include: Kings Sub-Basin; Kaweah Sub-Basin; and Tule Sub-Basin. Multiple Groundwater Sustainable Agencies (GSAs) are currently being establish in each groundwater sub-basin.
	section#GSALocations
		//-.container
			.row.text-center
				.col-sm-12
					h2.color-blue Water Project Central
			//-.row.text-center
				.col-sm-12
					a.btn.btn-blue.modal-trigger(data-modal-index='0' href="#")
						span.btn__text Have a Project Idea?

		//-.container.mt--2
			#Projects.row.masonry__container
				if contentful.projects != undefined
					- var max = 4
					for item in contentful.projects
						- max--
						if max >= 0
							- var cats = ''
							if item.categories != undefined
								for category in item.categories
									- cats+=' filter-'+category.fields.id
							.col-md-3.col-sm-6.masonry__item.project(class="#{cats}")
								a(href="#{item._url}")
									.imagebg.blue(data-overlay="5")
										.background-image-holder
											img(src="#{asset(item.headerImage)}")
										.container
											h5= item.title
											.stats.clearfix
												a.color-white(href="/project/#{item.id}#comments")
													i.comments.fa.fa-comment
													span.comment-count.disqus-comment-count(data-disqus-identifier="#{item.sys.id}")
												//-a.share(href="/share") Share
			.row.text-center
				.col-sm-12
						a.btn.btn-blue(href="/projects")
							span.btn__text See All Projects
		.container.mt--2
			.row.text-center
				.col-sm-12
					h2.color-blue GSA Locations
		#map-container.row.unmarg.pos-relative
			#map(style="height:100%;")
				script(src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.42.2/mapbox-gl.js')
				link(href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.42.2/mapbox-gl.css', rel='stylesheet')
				
				//- initial map center is based on the first project (if there is one, otherwise use a default coordinate)
				- var center = [-119.286733, 36.327473]
				if contentful.projects != undefined
					- var lng = contentful.projects[0].locationLng != undefined ? contentful.projects[0].locationLng : undefined
					- var lat = contentful.projects[0].locationLat != undefined ? contentful.projects[0].locationLat : undefined
					- if(lat != undefined && lng != undefined){center = [lng,lat]}
				//- initialize map
				script.
					mapboxgl.accessToken = 'pk.eyJ1IjoiZGVlcGZyeSIsImEiOiJjajUwNnowYnIyZGhnMzNyNGdkMThxYzNtIn0.2as5SwBqekMQuwmuxhQsjw';
					var map = new mapboxgl.Map({
						container: 'map',
						style: 'mapbox://styles/deepfry/cjc2ajuhd13hi2rl9qygm543r',
						zoom: 10,
						center: [#{center}],//default = [-119.286733, 36.327473],
						scrollZoom: false
					});
			#mapOverlay.pos-absolute.text-center
				if contentful.projects != undefined
					script.
						var geojson = {
							"id":"markers",
							"type": "FeatureCollection",
							"features": []
							}
					ul
						//- iterate through projects and push their info to the geojson object
						for project in contentful.projects
							if project.locationLat && project.locationLng != undefined
								li.location
									.imagebg
										.background-image-holder
											img(src="#{asset(project.headerImage)}")
									span.loc= project.title
									script.
										geojson.features.push({
											"type": "feature",
											"properties": {
												"title": "#{project.title}",
												"url":"#{project._url}"
												},
											"geometry": {
												"type": "Point",
												"coordinates": [#{project.locationLng}, #{project.locationLat}]
												}
										})
						script.
							geojson.features.forEach(function(marker) {
							// create a DOM element for the marker
							var el = document.createElement('div');
							el.className = 'marker';
							el.style.backgroundImage = 'url(/img/pin.png)';
							//el.style.backgroundImage = 'url(https://placekitten.com/g/' + marker.properties.iconSize.join('/') + '/)';
							el.style.width = '30px';
							el.style.height = '44px';
							el.addEventListener('mouseenter', function(e) {
								$('.mapboxgl-popup').hide();
								infoBox(marker)
							});
							// add marker to map
							new mapboxgl.Marker(el)
								.setLngLat(marker.geometry.coordinates)
								.addTo(map);
							});
				else
					h3.unmarg No projects at this time
	//-section.bg-lightblue
		.container
			.row.text-center
				.col-sm-12
					h2.color-white Water Resources
			.row#resources
				.col-sm-12
					ul.row.text-center
						li.col-sm-6.col-md-3.resource
							a(href="#")
								.imagebg
									.background-image-holder
										img(src="/img/test.jpg")
									.title.bg-blue
										h5 Resource Title
						li.col-sm-6.col-md-3.resource
							a(href="#")
								.imagebg
									.background-image-holder
										img(src="/img/test.jpg")
									.title.bg-blue
										h5 Resource Title
						li.col-sm-6.col-md-3.resource
							a(href="#")
								.imagebg
									.background-image-holder
										img(src="/img/test.jpg")
									.title.bg-blue
										h5 Resource Title
						li.col-sm-6.col-md-3.resource
							a(href="#")
								.imagebg
									.background-image-holder
										img(src="/img/test.jpg")
									.title.bg-blue
										h5 Resource Title
	//-section#whoweare
		.container
			#organizations.row
				.col-sm-4
					h3.color-blue Who makes up the Tule IRWMP?
					p.
						Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut ero labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco poriti laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in uienply voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat norin proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
				.col-sm-8
					.row.text-center
						.col-sm-4.organization
							.front.bg-blue
								.container
									h6 TESTING ORGAINZATION
							.back.bg-lightblue
								.container
									h6 background test!
						.col-sm-4.organization
							.front.bg-blue
								.container
									h6 TESTING ORGAINZATION
							.back.bg-lightblue
								.container
									h6 background test!
						.col-sm-4.organization
							.front.bg-blue
								.container
									h6 TESTING ORGAINZATION
							.back.bg-lightblue
								.container
									h6 background test!
						.col-sm-4.organization
							.front.bg-blue
								.container
									h6 TESTING ORGAINZATION
							.back.bg-lightblue
								.container
									h6 background test!
						.col-sm-4.organization
							.front.bg-blue
								.container
									h6 TESTING ORGAINZATION
							.back.bg-lightblue
								.container
									h6 background test!
	if contentful.meetings != undefined
		section#meetings
			.container
				.row.text-center
					.col-sm-12
						h2.color-blue Quarterly Meetings
				.row
					.col-sm-12
						table
							thead
								tr
									th Date
									th Agenda
									th Minutes
							tbody
								for meeting in contentful.meetings
									tr
										td
											a(href="#{meeting._url}")= meeting.title + ' - ' + meeting.dateFormatted.month + ' ' + meeting.dateFormatted.day + ' ' + meeting.dateFormatted.year
										if meeting.agenda != undefined
											td
												a(href="#{meeting._url}#agenda") Agenda
										else
											td Agenda TBA
										if meeting.minutes != undefined
											td
												a(href="#{meeting._url}#minutes") Minutes
										else
											td Minutes TBA
			.container
				.row.text-center
					.col-sm-12
						h2.color-blue Water Project Central
				.row.text-center
					.col-sm-12
						a.btn.blue.modal-trigger(data-modal-index='0' href="#")
							span.btn__text Have a Project Idea?
	section#contact.bg-brown
		.container
			.row
				.col-sm-12
					h2.white-underline.color-white CONTACT
			.row
				.col-sm-8.col-md-7.center-column
					.row.text-center
						form.text-left.form-email.attempted-submit(action="/thankyou" data-success="Thanks for your enquiry, we'll be in touch shortly.", data-error='Please fill in all fields correctly.', data-recaptcha-theme='light', netlify='' novalidate='true')
							.col-sm-6
								label.color-white Your Name:
								input.validate-required(type='text', name='Name')
							.col-sm-6
								label.color-white Email Address:
								input.validate-required.validate-email(type='email', name='Email')
							.col-sm-12
								label.color-white Message:
								textarea.validate-required(rows='6', name='Message')
							.col-sm-5.col-md-4.center-column
								a.btn.white(type='submit', data-text='Send Enquiry')
									span.btn__text Send Enquiry
